%% Generated by Sphinx.
\def\sphinxdocclass{jupyterBook}
\documentclass[review]{elsarticle}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsible pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}
%% turn off hyperref patch of \index as sphinx.xdy xindy module takes care of
%% suitable \hyperpage mark-up, working around hyperref-xindy incompatibility
\PassOptionsToPackage{hyperindex=false}{hyperref}
%% memoir class requires extra handling
\makeatletter\@ifclassloaded{memoir}
{\ifdefined\memhyperindexfalse\memhyperindexfalse\fi}{}\makeatother

\PassOptionsToPackage{warn}{textcomp}


\usepackage{cmap}

\usepackage{amsmath,amssymb,amstext}
\usepackage{polyglossia}
\usepackage{color,soul}
\setmainlanguage{english}






\usepackage[,numfigreset=1,mathnumfig]{sphinx}

\fvset{fontsize=\small}
\usepackage{geometry}


% Include hyperref last.

\usepackage{hyperref}
\def\equationautorefname~#1\null{Eq.#1\null}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}


\usepackage{sphinxmessages}



        % Start of preamble defined in sphinx-jupyterbook-latex %
         \usepackage[Latin,Greek]{ucharclasses}
        \usepackage{unicode-math}
        % fixing title of the toc
        \addto\captionsenglish{\renewcommand{\contentsname}{Contents}}
        \hypersetup{
            pdfencoding=auto,
            psdextra
        }
        % End of preamble defined in sphinx-jupyterbook-latex %
        

\title{System identification of Vessel Manoeuvring Models}
\date{Jul 21, 2022}
\release{}
%\author{Martin Alexandersson}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{}
\makeindex
\begin{document}
\input{front}


\pagestyle{empty}

\pagestyle{plain}

\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}



\section{Introduction}
\label{\detokenize{00.02_introduction:introduction}}\label{\detokenize{00.02_introduction::doc}}
\sphinxAtStartPar
Prediction of a ship’s manoeuvring performance is required in a wide range of applications such as the manoeuvrability requirement for ship design/construction, design of advanced ship autopilot systems or master mariners’ training simulators. Ship manoeuvring performance can be assessed in many ways, with varying accuracy, effort, and cost. The full scale manoeuvring test is the most reliable method and is used to demonstrate the compliance with the IMO manoeuvring criteria {[}\hyperlink{cite.bibligraphy:id16}{IMO02}{]} during sea trials, which all ships longer than 100 must fulfil. Therefore, some manoeuvring prediction methods are needed before ships are built, for example the free model test is often recognized as the most accurate prediction method {[}\hyperlink{cite.bibligraphy:id75}{ITT08}{]}. 
But this method only gives results for one specific manoeuvre, alternative manoeuvres require new tests to be conducted and large efforts. Some complex manoeuvres such as harbor manoeuvres are also very difficult to conduct in a free model test.
Instead, the system based manoeuvring simulation is also used where captive model tests can be conducted as inputs to a Vessel Manoeuvring Model (VMM). These tests are more costly and the increased flexibility of the developed mathematical model gives lower accuracy {[}\hyperlink{cite.bibligraphy:id75}{ITT08}{]}. System identification methods can be applied to the free model tests, as an alternative more cost efficient way to develop VMMs.

\sphinxAtStartPar
Both statistical regression and Non-parametric black box approaches have been used for the system identification {[}\hyperlink{cite.bibligraphy:id82}{HWZL22}{]}. However, most of today’s system identification methods for developing ship manoeuvring models assume a pre\sphinxhyphen{}defined mathematical model, so that the problem reduces into the parameter identification (PIT) or rather parameter estimation. Kalman Filter (KF), Extended Kalman Filter (EKF) or machine learning methods such as Support Vector Regression (SVR) are common choices to regress the parameters. The KF/EKF are either used as a pre\sphinxhyphen{}processing filter or as the parameter estimator. The KF combined with Maximum Likelihood Estimation was proposed already in 1976 {[}\hyperlink{cite.bibligraphy:id30}{AK76}{]} to develop a linear manoeuvring model based on data that was manually recorded in 1969 onboard the Atlantic Song freighter. The EKF can also estimate parameters if the parameters are represented as states of the state space model. This technique was used on a nonlinear Nomoto model {[}\hyperlink{cite.bibligraphy:id33}{POGS15}{]}, and a 3 degree of freedom model (3DOF), etc., but based on simulated data {[}\hyperlink{cite.bibligraphy:id54}{SZPS09}{]}.
A lot of investigations using machine learning methods have been conducted lately. For example, SVR has become very popular, where the penalty factor can be tuned to handle measurement noise. This has been investigated using simulated data in {[}\hyperlink{cite.bibligraphy:id38}{ZHWB17}{]} and {[}\hyperlink{cite.bibligraphy:id47}{WLW+21}{]} and using measured data from free model tests in {[}\hyperlink{cite.bibligraphy:id56}{Luo16}{]}.
The drift effect of the hydrodynamic coefficients is inevitable in modeling of ship manoeuvring motions by using the System Identification (SI) techniques. The drifts of hydrodynamic coefficients result from the so\sphinxhyphen{}called multicollinearity. It means if the input variables of a regression model are strongly linearly dependent on each other, the regression results of their coefficients may be incorrect {[}\hyperlink{cite.bibligraphy:id56}{Luo16}{]}. The identified coefficients within the mathematical model do not have to be physically correct, but mathematically correct {[}\hyperlink{cite.bibligraphy:id75}{ITT08}{]}. In fact, many nonlinear hydrodynamic coefficients in the mathematical model of ship manoeuvring motions have no clear physical meaning {[}\hyperlink{cite.bibligraphy:id56}{Luo16}{]}. Multicollinearity can be reduced by reducing the number of parameters in the model, either by simplification or adding more deterministic parts by including hydrodynamic relations for instance by adding slender body theory {[}\hyperlink{cite.bibligraphy:id80}{Hwa82}{]}. Simplification can be based on hydrodynamic reasoning where the number of parameters in the well\sphinxhyphen{}known Abkowitz yaw equation {[}\hyperlink{cite.bibligraphy:id25}{Abk64}{]} can be reduced from 22 to 14 {[}\hyperlink{cite.bibligraphy:id56}{Luo16}{]}.

\sphinxAtStartPar
However, system identification methods must handle imperfections in the data from measurement noise as well as imperfection in the VMM which will always be present since the model can never capture the real physics perfectly. When developing a VMM with model test data for manoeuvring prediction, preprocessing of data and a method to chose an appropriate VMM is needed. In this paper, an innovative approach is proposed to address those issues for ship manoeuvring system identification based on actual noise test data. A Parameter Identification Technique (PIT) is first proposed to study the capability of several candidate VMMs. The PIT uses model test data with a ship model free in all degrees of freedoms recorded as ship trajectories (position and heading) and propeller thrust. And the most appropriate VMM is selected by proposing an iterative approach. Especially, the multicollinearity problem is addressed by identifying a ship manoeuvring system with proper parameters in the VMM.  The method is verified by identifying a selected VMM and predicting turning circle manoeuvres for two different test vessels.

\sphinxAtStartPar
For the completeness of this paper, different VMMs and propeller models are briefly introduced in \hyperref[\detokenize{02.01_VMMs:vmm}]{Section \ref{\detokenize{02.01_VMMs:vmm}}}. Then the proposed PIT algorithm to identify the parameters in the VMMs is presented in \hyperref[\detokenize{01.01_method:method}]{Section \ref{\detokenize{01.01_method:method}}}, where each subcomponent is also described. The PIT is applied to two case study ships which are introduced in \hyperref[\detokenize{05.01_case_studies:case-studies}]{Section \ref{\detokenize{05.01_case_studies:case-studies}}} and corresponding results are presented in the \hyperref[\detokenize{06.01_results:results}]{Section \ref{\detokenize{06.01_results:results}}}, followed by conclusions.


\section{Vessel Manoeuvring Model Models}
\label{\detokenize{02.01_VMMs:models}}\label{\detokenize{02.01_VMMs:vmm}}\label{\detokenize{02.01_VMMs::doc}}
\sphinxAtStartPar
Ship manoeuvring is a simplified case of seakeeping. The encountering waves have been removed, assuming calm water conditions. This simplification allows for the ship dynamics to be expressed with only four degrees of freedom: surge, sway, roll and yaw, where roll is often excluded. Surge, sway and yaw have very low frequencies during manoeuvres, so that added masses as well as other hydrodynamic derivatives can be assumed as constants {[}\hyperlink{cite.bibligraphy:id87}{Fos21}{]}. Three Vessel Manoeuvring Models (VMMs) are used in this paper: Linear (LVMM), {[}\hyperlink{cite.bibligraphy:id40}{Mat17}{]}, Abkowitz model (AVMM){[}\hyperlink{cite.bibligraphy:id25}{Abk64}{]} and a Modified Abkowitz model (MAVMM) proposed in this study. All the existed VMMs have a very similar structure.

\sphinxAtStartPar
\hyperref[\detokenize{02.01_VMMs:coordinate-system}]{Fig.\@ \ref{\detokenize{02.01_VMMs:coordinate-system}}} shows the coordinate systems used in the VMMs where \(x_0\) and \(y_0\) and heading \(\Psi\) are the global position and orientation of a ship fix coordinate system \(O(x,y,z)\),  with origin at midship. \(u\), \(v\), \(r\), \(X\), \(Y\) and \(N\) are velocities and forces in the ship fix coordinate system.

\begin{figure}[H]
\centering
\capstart

\noindent\sphinxincludegraphics[height=200\sphinxpxdimen]{{coordinate_system}.PNG}
\caption{Coordinate system}\label{\detokenize{02.01_VMMs:coordinate-system}}\end{figure}

\sphinxAtStartPar
\begin{equation}\label{equation:02.01_VMMs:eqqsystem}
\begin{split}\displaystyle \left[\begin{matrix}- X_{\dot{u}} + m & 0 & 0\\0 & - Y_{\dot{v}} + m & - Y_{\dot{r}} + m x_{G}\\0 & - N_{\dot{v}} + m x_{G} & I_{z} - N_{\dot{r}}\end{matrix}\right] \left[\begin{matrix}\dot{u}\\\dot{v}\\\dot{r}\end{matrix}\right] = \left[\begin{matrix}m r^{2} x_{G} + m r v + \operatorname{X_{D}}{\left(u,v,r,\delta,thrust \right)}\\- m r u + \operatorname{Y_{D}}{\left(u,v,r,\delta,thrust \right)}\\- m r u x_{G} + \operatorname{N_{D}}{\left(u,v,r,\delta,thrust \right)}\end{matrix}\right]\end{split}
\end{equation}

The above equation {[}\hyperlink{cite.bibligraphy:id87}{Fos21}{]} can be rewritten to get the acceleration on the left hand side as,

\begin{equation}\label{equation:02.01_VMMs:eqacc}
\begin{split}\displaystyle \dot{\nu} = \left[\begin{matrix}\dot{u}\\\dot{v}\\\dot{r}\end{matrix}\right] = \left[\begin{matrix}\frac{1}{- X_{\dot{u}} + m} & 0 & 0\\0 & - \frac{- I_{z} + N_{\dot{r}}}{S} & - \frac{- Y_{\dot{r}} + m x_{G}}{S}\\0 & - \frac{- N_{\dot{v}} + m x_{G}}{S} & - \frac{Y_{\dot{v}} - m}{S}\end{matrix}\right] \left[\begin{matrix}m r^{2} x_{G} + m r v + \operatorname{X_{D}}{\left(u,v,r,\delta,thrust \right)}\\- m r u + \operatorname{Y_{D}}{\left(u,v,r,\delta,thrust \right)}\\- m r u x_{G} + \operatorname{N_{D}}{\left(u,v,r,\delta,thrust \right)}\end{matrix}\right]\end{split}
\end{equation}
\sphinxAtStartPar
where \(S\) is a helper variable:
\begin{equation}\label{equation:02.01_VMMs:eq_S}
\begin{split}\displaystyle S = - I_{z} Y_{\dot{v}} + I_{z} m + N_{\dot{r}} Y_{\dot{v}} - N_{\dot{r}} m - N_{\dot{v}} Y_{\dot{r}} + N_{\dot{v}} m x_{G} + Y_{\dot{r}} m x_{G} - m^{2} x_{G}^{2}\end{split}
\end{equation}
\sphinxAtStartPar
A state space model for manoeuvring can now be defined with six states:
\begin{equation}\label{equation:02.01_VMMs:eq_x}
\begin{split}\displaystyle \mathbf{x} = \left[\begin{matrix}x_{0}\\y_{0}\\\Psi\\u\\v\\r\end{matrix}\right]\end{split}
\end{equation}
\sphinxAtStartPar
The time derivative of this state \(\dot{\mathbf{x}}\) can be defined by a state transition \(f(\mathbf{x},\mathbf{c})\) using geometrical relations how global coordinates \(x_0\), \(y_0\) and \(\Psi\) depend on \(u\), \(v\), and \(r\) viz.,

\begin{equation}\label{equation:02.01_VMMs:eqf}
\begin{split}\displaystyle \dot{\mathbf{x}} = f(\mathbf{x},\mathbf{c}) + \mathbf{w} = \left[\begin{matrix}u \cos{\left(\Psi \right)} - v \sin{\left(\Psi \right)}\\u \sin{\left(\Psi \right)} + v \cos{\left(\Psi \right)}\\r\\\dot{u}\\\dot{v}\\\dot{r}\end{matrix}\right] + \mathbf{w}\end{split}
\end{equation}

where \(\mathbf{c}\) is control inputs (rudder angle \(\delta\) and thrust $T$); the last three derivatives: \(\dot{u}\), \(\dot{v}\), \(\dot{r}\) are calculated with \autoref{equation:02.01_VMMs:eqacc}. \(\mathbf{w}\) is the  process noise, i.e., the difference between the predicted state by the VMM and the true state of the system. \(\mathbf{w}\) is unknown when the VMM is used for manoeuvre predictions and therefore normally assumed to be zero, but it is an important factor when the VMM is used in the EKF.


\sphinxAtStartPar
The manoeuvring simulation can now be conducted by numerical integration of \autoref{equation:02.01_VMMs:eqf}. The main difference between the VMMs lies in how the hydrodynamic functions \(X_D(u,v,r,\delta,T)\), \(Y_D(u,v,r,\delta,T)\), \(N_D(u,v,r,\delta,T)\) are defined. These expressions are denoted for different VMMS, namely LVMM, AVMM and MAVMM below,

\sphinxAtStartPar
LVMM (Linear Vessel Manoeuvring Model):
\begin{equation}\label{equation:02.01_VMMs:eqxlinear}
\begin{split}\begin{split}
\operatorname{X_{D}'}{\left(u',v',r',\delta,T' \right)} = & X_{\delta} \delta + X_{r} r' + X_{u} u' + X_{v} v' 
\end{split}\end{split}
\end{equation}\begin{equation}\label{equation:02.01_VMMs:eqylinear}
\begin{split}\begin{split}
\operatorname{Y_{D}'}{\left(u',v',r',\delta,T' \right)} = & Y_{\delta} \delta + Y_{r} r' + Y_{u} u' + Y_{v} v' 
\end{split}\end{split}
\end{equation}\begin{equation}\label{equation:02.01_VMMs:eqnlinear}
\begin{split}\begin{split}
\operatorname{N_{D}'}{\left(u',v',r',\delta,T' \right)} = & N_{\delta} \delta + N_{r} r' + N_{u} u' + N_{v} v' 
\end{split}\end{split}
\end{equation}
\sphinxAtStartPar
AVMM (Abkowitz Vessel Manoeuvring Model):
\begin{equation}\label{equation:02.01_VMMs:eqxabkowitz}
\begin{split}\begin{split}
\operatorname{X_{D}'}{\left(u',v',r',\delta,T' \right)} = & X_{\delta\delta} \delta^{2} + X_{r\delta} \delta r' + X_{rr} r'^{2} + X_{T} T' + X_{u\delta\delta} \delta^{2} u' + X_{ur\delta} \delta r' u' + X_{urr} r'^{2} u' + X_{uuu} u'^{3} \\
& + X_{uu} u'^{2} + X_{uv\delta} \delta u' v' + X_{uvr} r' u' v' + X_{uvv} u' v'^{2} + X_{u} u' + X_{v\delta} \delta v' + X_{vr} r' v' + X_{vv} v'^{2} 
\end{split}\end{split}
\end{equation}\begin{equation}\label{equation:02.01_VMMs:eqyabkowitz}
\begin{split}\begin{split}
\operatorname{Y_{D}'}{\left(u',v',r',\delta,T' \right)} = & Y_{0uu} u'^{2} + Y_{0u} u' + Y_{0} + Y_{\delta\delta\delta} \delta^{3} + Y_{\delta} \delta + Y_{r\delta\delta} \delta^{2} r' + Y_{rr\delta} \delta r'^{2} + Y_{rrr} r'^{3} \\
& + Y_{r} r' + Y_{T\delta} \delta T' + Y_{T} T' + Y_{u\delta} \delta u' + Y_{ur} r' u' + Y_{uu\delta} \delta u'^{2} + Y_{uur} r' u'^{2} + Y_{uuv} u'^{2} v' \\
& + Y_{uv} u' v' + Y_{v\delta\delta} \delta^{2} v' + Y_{vr\delta} \delta r' v' + Y_{vrr} r'^{2} v' + Y_{vv\delta} \delta v'^{2} + Y_{vvr} r' v'^{2} + Y_{vvv} v'^{3} + Y_{v} v' 
\end{split}\end{split}
\end{equation}\begin{equation}\label{equation:02.01_VMMs:eqnabkowitz}
\begin{split}\begin{split}
\operatorname{N_{D}'}{\left(u',v',r',\delta,T' \right)} = & N_{0uu} u'^{2} + N_{0u} u' + N_{0} + N_{\delta\delta\delta} \delta^{3} + N_{\delta} \delta + N_{r\delta\delta} \delta^{2} r' + N_{rr\delta} \delta r'^{2} + N_{rrr} r'^{3} \\
& + N_{r} r' + N_{T\delta} \delta T' + N_{T} T' + N_{u\delta} \delta u' + N_{ur} r' u' + N_{uu\delta} \delta u'^{2} + N_{uur} r' u'^{2} + N_{uuv} u'^{2} v' \\
& + N_{uv} u' v' + N_{v\delta\delta} \delta^{2} v' + N_{vr\delta} \delta r' v' + N_{vrr} r'^{2} v' + N_{vv\delta} \delta v'^{2} + N_{vvr} r' v'^{2} + N_{vvv} v'^{3} + N_{v} v' 
\end{split}\end{split}
\end{equation}
\sphinxAtStartPar
MAVMM (Modified Abkowitz Vessel Manoeuvring Model) where only the most relevant coefficients in AVMM are included.
\begin{equation}\label{equation:02.01_VMMs:eqxmartinssimple}
\begin{split}\begin{split}
\operatorname{X_{D}'}{\left(u',v',r',\delta,T' \right)} = & X_{\delta\delta} \delta^{2} + X_{rr} r'^{2} + X_{T} T' + X_{uu} u'^{2} + X_{u} u' + X_{vr} r' v' 
\end{split}\end{split}
\end{equation}\begin{equation}\label{equation:02.01_VMMs:eqymartinssimple}
\begin{split}\begin{split}
\operatorname{Y_{D}'}{\left(u',v',r',\delta,T' \right)} = & Y_{\delta} \delta + Y_{r} r' + Y_{T\delta} \delta T' + Y_{T} T' + Y_{ur} r' u' + Y_{u} u' + Y_{vv\delta} \delta v'^{2} + Y_{v} v' 
\end{split}\end{split}
\end{equation}\begin{equation}\label{equation:02.01_VMMs:eqnmartinssimple}
\begin{split}\begin{split}
\operatorname{N_{D}'}{\left(u',v',r',\delta,T' \right)} = & N_{\delta} \delta + N_{r} r' + N_{T\delta} \delta T' + N_{T} T' + N_{ur} r' u' + N_{u} u' + N_{vv\delta} \delta v'^{2} + N_{v} v' 
\end{split}\end{split}
\end{equation}
\sphinxAtStartPar
The hydrodynamic functions above are expressed with nondimensional prime units. The quantities are expressed in the prime system, using the denominators in \hyperref[\detokenize{02.01_VMMs:prime-system-denominators}]{Table \ref{\detokenize{02.01_VMMs:prime-system-denominators}}}.


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxthecaptionisattop
\sphinxcaption{Prime system denominators}\label{\detokenize{02.01_VMMs:prime-system-denominators}}
\sphinxaftertopcaption
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily &\sphinxstyletheadfamily 
\sphinxAtStartPar
Denominators
\\
\hline
\sphinxAtStartPar
length
&
\sphinxAtStartPar
\(L\)
\\
\hline
\sphinxAtStartPar
volume
&
\sphinxAtStartPar
\(L^{3}\)
\\
\hline
\sphinxAtStartPar
mass
&
\sphinxAtStartPar
\(\frac{L^{3} \rho}{2}\)
\\
\hline
\sphinxAtStartPar
density
&
\sphinxAtStartPar
\(\frac{\rho}{2}\)
\\
\hline
\sphinxAtStartPar
inertia
moment
&
\sphinxAtStartPar
\(\frac{L^{5} \rho}{2}\)
\\
\hline
\sphinxAtStartPar
time
&
\sphinxAtStartPar
\(\frac{L}{U}\)
\\
\hline
\sphinxAtStartPar
frequency
&
\sphinxAtStartPar
\(\frac{U}{L}\)
\\
\hline
\sphinxAtStartPar
area
&
\sphinxAtStartPar
\(L^{2}\)
\\
\hline
\sphinxAtStartPar
angle
&
\sphinxAtStartPar
\(1\)
\\
\hline
\sphinxAtStartPar
linear
velocity
&
\sphinxAtStartPar
\(U\)
\\
\hline
\sphinxAtStartPar
angular
velocity
&
\sphinxAtStartPar
\(\frac{U}{L}\)
\\
\hline
\sphinxAtStartPar
linear
acceleration
&
\sphinxAtStartPar
\(\frac{U^{2}}{L}\)
\\
\hline
\sphinxAtStartPar
angular
acceleration
&
\sphinxAtStartPar
\(\frac{U^{2}}{L^{2}}\)
\\
\hline
\sphinxAtStartPar
force
&
\sphinxAtStartPar
\(\frac{L^{2} U^{2} \rho}{2}\)
\\
\hline
\sphinxAtStartPar
moment
&
\sphinxAtStartPar
\(\frac{L^{3} U^{2} \rho}{2}\)
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\subsection{Propeller model}
\label{\detokenize{02.10_propeller_model:propeller-model}}\label{\detokenize{02.10_propeller_model::doc}}
\sphinxAtStartPar
The propeller model is developed based on MMG model {[}\hyperlink{cite.bibligraphy:id22}{YY15}{]} where the thrust is expressed as:
\begin{equation}\label{equation:02.10_propeller_model:eqT}
\begin{split}\displaystyle T = D^{4} K_{T} rev^{2} \rho\end{split}
\end{equation}
\sphinxAtStartPar
And thrust coefficient \(K_T\) is modelled as a second order polynomial:
\begin{equation}\label{equation:02.10_propeller_model:eqkt}
\begin{split}\displaystyle K_{T} = J^{2} k_{2} + J k_{1} + k_{0}\end{split}
\end{equation}
\sphinxAtStartPar
The advance ration \(J\) is calculated as:
\begin{equation}\label{equation:02.10_propeller_model:eqJ}
\begin{split}\displaystyle J = \frac{u \left(1 - w_{p}\right)}{D rev}\end{split}
\end{equation}
\sphinxAtStartPar
where \(D\) is propeller diameter, \(rev\) is propeller speed and \(w_p\) is the wake fraction at an oblique inflow to the propeller from drift angle an yaw rate. A semi\sphinxhyphen{}empirical formula for \(w_p\) is provided in the MMG model. As an alternative, a simple polynomial is proposed in \autoref{equation:02.10_propeller_model:eqpropellermodel}.
\begin{equation}\label{equation:02.10_propeller_model:eqpropellermodel}
\begin{split}\displaystyle w_{p} = C_{1} \delta + C_{2} \delta^{2} + C_{3} \beta_{p}^{2} + C_{4} u + w_{p0}\end{split}
\end{equation}
\sphinxAtStartPar
\(w_p\) is modeled as function of rudder angle \(\delta\), to include wake influence from the rudder and ship speed \(u\), to include a speed dependency. The influence from drift angle \(\beta\) and yaw rate \(r\) is expressed by \(\beta_p\) in \autoref{equation:02.10_propeller_model:eqbetap}.
\begin{equation}\label{equation:02.10_propeller_model:eqbetap}
\begin{split}\beta_p=\beta - \frac{r}{U} \cdot x_p \end{split}
\end{equation}
\sphinxAtStartPar
Where \(x_p\) is the propeller longitudinal position and \(w_{p0}\) is the regular Taylor wake fraction, applicable to straight ahead steaming with no rudder angle. Similar to the MMG propeller model, two sets of parameters \(C_1\)\sphinxhyphen{}\(C_4\) should be used in the propeller model depending on the sign of \(\beta_p\).


\section{Method}
\label{\detokenize{01.01_method:method}}\label{\detokenize{01.01_method:id1}}\label{\detokenize{01.01_method::doc}}
\sphinxAtStartPar
The system identification can then be simplified into parameter identification if a Mathematical Vessel Manoeuvring Model (VMM) is assumed to describe the ship manoeuvring system. An efficient approach to build the VMM for a ship’s manoeuvres is proposed here and presented in \hyperref[\detokenize{01.01_method:overview}]{Fig.\@ \ref{\detokenize{01.01_method:overview}}}.
In this procedure, an initial VMM is used to solve the reversed manoeuvring problem, i.e., predicting unknown forces from known ship manoeuvres. Then, the hydrodynamic derivatives in the VMM can be identified with regression of the force polynomials on forces predicted with inverse dynamics. The Ordinary Least Square (OLS) method is used to regress the hydrodynamic derivatives. The OLS is known to be extremely sensitive to noise and outliers inevitably associated with both experimental and full\sphinxhyphen{}scale test data. Thereby, the focus in the present PIT is on pre\sphinxhyphen{}processing data with filtering rather than the regression method itself. Both the Extended Kalman Filter (EKF) and Rauch Tung Striebel (RTS) smoother are used to perform the data\sphinxhyphen{}processing for building a proper VMM.

\begin{figure}[H]
\centering
\capstart

\noindent\sphinxincludegraphics[width=500\sphinxpxdimen]{{method}.png}
\caption{Flow chart over the proposed Parameter Identification Technique (PIT)}\label{\detokenize{01.01_method:overview}}\end{figure}


\subsection{Overview of the proposed procedure}
\label{\detokenize{01.01_method:overview-of-the-proposed-procedure}}
\sphinxAtStartPar
After choosing a proper VMM model to describe a ship’s manoeuvring performance, the coefficients in those VMMs can be estimated by the proposed PIT method in \hyperref[\detokenize{01.01_method:overview}]{Fig.\@ \ref{\detokenize{01.01_method:overview}}}. During the estimation process, an initial guess of VMM is required as the input system model in the EKF, and updated iteratively. The iterative process in the proposed PIT method are composed of two basic steps:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{)}%
\item {} 
\sphinxAtStartPar
First, hydrodynamic derivatives of a pre\sphinxhyphen{}defined format of VMM are initially guessed. To make a fair guess, the derivatives are estimated with semi\sphinxhyphen{}empirical formulas for a linear VMM. The VMM is used in the EKF and RTS smoother to filter all the model tests. The VMMs are assumed to have Markov property which means that future states depend only on the current state. Then the filtered data with estimated hidden states from all the model tests can be joined into a time independent dataset passed to the motion regression. The hydrodynamic derivatives are regressed on quasi\sphinxhyphen{}static forces from inverse dynamics giving the identified nonlinear VMM.

\item {} 
\sphinxAtStartPar
Re\sphinxhyphen{}run the iteration in the previous step with EKF that use the identified VMM from the previous step to replace the guessed system model in the initial stage (with AVMM, MAVMM, etc.). There should be a higher belief in this model than the guessed model, so the covariance matrices should be updated.

\end{enumerate}

\sphinxAtStartPar
An example with simulation results from the steps in the iterative EKF is shown in \hyperref[\detokenize{01.01_method:iterations}]{Fig.\@ \ref{\detokenize{01.01_method:iterations}}}.

\begin{figure}[H]
\centering
\capstart

\noindent\sphinxincludegraphics{{2018955274d69cb3f163b5924a5395c1adb965e27360d0473d17e20243a0c76c}.pdf}
\caption{Simulation with: initial model, first and second iteration of the PIT}\label{\detokenize{01.01_method:iterations}}\end{figure}

\sphinxAtStartPar
In the following, the methods of inverse dynamics, regression and EKF used in the proposed PIT method, and their connections, are presented in detail.


\subsection{Inverse dynamics and regression}\hl{this part needs to rewritten!}
\label{\detokenize{03.01_inverse_dynamics:inverse-dynamics-and-regression}}\label{\detokenize{03.01_inverse_dynamics::doc}}
\sphinxAtStartPar
Each manoeuvring model has some hydrodynamic functions \(X_D(u,v,r,\delta,T)\), \(Y_D(u,v,r,\delta,T)\), \(N_D(u,v,r,\delta,T)\) that are defined as polynomials. The hydrodynamic derivatives in these polynomials can be identified with force regression of measured forces and moments. The measured forces and moments are usually taken from Captive Model Tests (CMT), Planar Motion Mechanism (PMM) tests or Virtual Captive Tests (VCT) which is being the virtual version of CMT/PMM tests calculated with Computational Fluid Dynamics (CFD). When the ship is free in all degrees of freedom, only motions can be observed, as in the present model tests. Hence, forces and moments causing ship motions need to be estimated by solving the inverse dynamics problem.

\sphinxAtStartPar
The inverse dynamics is solved by restructuring the system equation (\autoref{equation:02.01_VMMs:eqqsystem}) to get the hydrodynamics functions on the left hand side. If the mass and inertia of the ship including added masses: \(\dot{u}\), \(\dot{v}\), \(\dot{r}\) are known, the forces can be calculated using \autoref{equation:03.01_inverse_dynamics:eqxd}, \autoref{equation:03.01_inverse_dynamics:eqyd} and \autoref{equation:03.01_inverse_dynamics:eqnd}.
\begin{equation}\label{equation:03.01_inverse_dynamics:eqxd}
\begin{split}\displaystyle \operatorname{X_{D}}{\left(u,v,r,\delta,T \right)} = - X_{\dot{u}} \dot{u} + \dot{u} m - m r^{2} x_{G} - m r v\end{split}
\end{equation}\begin{equation}\label{equation:03.01_inverse_dynamics:eqyd}
\begin{split}\displaystyle \operatorname{Y_{D}}{\left(u,v,r,\delta,T \right)} = - Y_{\dot{r}} \dot{r} - Y_{\dot{v}} \dot{v} + \dot{r} m x_{G} + \dot{v} m + m r u\end{split}
\end{equation}\begin{equation}\label{equation:03.01_inverse_dynamics:eqnd}
\begin{split}\displaystyle \operatorname{N_{D}}{\left(u,v,r,\delta,T \right)} = I_{z} \dot{r} - N_{\dot{r}} \dot{r} - N_{\dot{v}} \dot{v} + \dot{v} m x_{G} + m r u x_{G}\end{split}
\end{equation}
\sphinxAtStartPar
An example of forces calculated with inverse dynamics from motions in a turning circle test can be seen in \hyperref[\detokenize{03.01_inverse_dynamics:fig-inverse}]{Fig.\@ \ref{\detokenize{03.01_inverse_dynamics:fig-inverse}}}.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_remove_input}
\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{figure}[H]
\centering
\capstart

\noindent\sphinxincludegraphics{{2f3f469d2959f2e85d9d496be97831d1772321067aceeb441a187d1fa56257f8}.pdf}
\caption{Example of forces and moments calculated with inverse dynamics on data from a turning circle test.}\label{\detokenize{03.01_inverse_dynamics:fig-inverse}}\end{figure}

\sphinxAtStartPar
Finding the the hydrodynamic derivatives can be defined as a linear regression problem:
\begin{equation}\label{equation:03.01_inverse_dynamics:eqregression}
\begin{split}y = X\beta + \epsilon\end{split}
\end{equation}
\sphinxAtStartPar
A model for the hydrodynamic forces first needs to be assumed for instance as the polynomials in the MAVMM.

\sphinxAtStartPar
The label vector \(y\) and feature matrix \(X\) in the regression problem in \autoref{equation:03.01_inverse_dynamics:eqregression} can now be inserted. As an example: the labels in the regression of surge degree of freedom can be calculated using the inverse dynamics force:
\begin{equation}\label{equation:03.01_inverse_dynamics:diff_eq_X_y}
\begin{split}\displaystyle y = - X_{\dot{u}} \dot{u}' + \dot{u}' m' - m' r'^{2} x_{G'} - m' r' v'\end{split}
\end{equation}
\sphinxAtStartPar
The feature matrix \(X\) is expressed as:
\begin{equation}\label{equation:03.01_inverse_dynamics:diff_eq_X_X}
\begin{split}\displaystyle X = \left[\begin{matrix}T' & u' & \delta^{2} & r'^{2} & u'^{2} & r' v'\end{matrix}\right]\end{split}
\end{equation}
\sphinxAtStartPar
The regressed hydrodynamic derivatives are stored in the \(\beta\) vector:
\begin{equation}\label{equation:03.01_inverse_dynamics:diff_eq_X_beta}
\begin{split}\displaystyle \beta = \left[\begin{matrix}X_{T}\\X_{u}\\X_{\delta\delta}\\X_{rr}\\X_{uu}\\X_{vr}\end{matrix}\right]\end{split}
\end{equation}
\sphinxAtStartPar
The hydrodynamic derivatives in the VMM are considered as Gaussian random variables when conducting the OLS regression. The hydrodynamic derivatives in the VMM are normally taken as the mean value of each regressed random variable, being the most likely estimate. The regression result can be described with a Multivariate Gaussian Distribution, defined by the mean values and covariance matrix from the regression. Monte Carlo simulations can be conducted with this distribution to study alternative realizations of the regression.

\sphinxAtStartPar
Strong multicollinearity is a known problem for the the VMM:s {[}\hyperlink{cite.bibligraphy:id36}{LGSZ16}{]}, {[}\hyperlink{cite.bibligraphy:id58}{WZ18}{]}.
The thrust coefficient \(X_T\) in the hydrodynamic function \(X_D\) in \autoref{equation:02.01_VMMs:eqxabkowitz} introduces multicollinearity to the regression. This coefficient is therefore instead calculated from the thrust deduction factor \(t_{df}\):
\begin{equation}\label{equation:03.01_inverse_dynamics:eqXthrust}
\begin{split}\displaystyle X_{T} = thrust \left(1 - t_{df}\right)\end{split}
\end{equation}
\sphinxAtStartPar
The \(X_T\) coefficient is excluded from the regression by moving it to the left hand side of the regression equation \autoref{equation:03.01_inverse_dynamics:eqregression}:
\begin{equation}\label{equation:03.01_inverse_dynamics:eqexclude}
\begin{split}y-X_T \cdot T = X \beta + \epsilon\end{split}
\end{equation}
\sphinxAtStartPar
Rudder coefficients (\(Y_R\)) from \(Y_D\) equation \autoref{equation:02.01_VMMs:eqyabkowitz} such as \(Y_{\delta}\), \(Y_{\delta T}\) etc. have been excluded in the same way by assuming a connection with their \(N_D\) equation counter part through the rudder lever arm \(x_r\):
\begin{equation}\label{equation:03.01_inverse_dynamics:eqyr}
\begin{split}\displaystyle Y_{R} = \frac{N_{R}}{x_{r}}\end{split}
\end{equation}

\subsection{Extended Kalman Filter (EKF)}
\label{\detokenize{04.01_EK:extended-kalman-filter-ekf}}\label{\detokenize{04.01_EK::doc}}

\subsubsection{The EKF recursive algorithm}
\label{\detokenize{04.01_EK:the-ekf-recursive-algorithm}}
\sphinxAtStartPar
It is possible to do parameter identification on perfect (simulated) data with no noise (see Section \ref{\detokenize{06.40_results_inverse_dynamics::doc}}). However, such data from physical experiments does not exist in reality. The measured data will always contain process noise and measurement noise. In order to mitigate this, the data is pre\sphinxhyphen{}processed using an Extended Kalman filter (EKF). EKF  is extending the Kalman Filter (KF) to work on nonlinear systems such as as the VMMs. The basic idea is that noise can be disregarded if it does not make sense from a physical point of view. If noisy measurement data would be perfectly correct, this would mean that the ship has a lot of vibrations that must have originated from huge forces, considering the large mass of the ship. The prior understanding of model tests suggests that these huge forces are not present during the test, and the noise is therefore considered as measurement noises that should be removed. Low\sphinxhyphen{}pass filtering is a common way to remove noise, where motions above some cut\sphinxhyphen{}off frequencies are regarded as unphysical measurement noise. The problem with low\sphinxhyphen{}pass filter is that it is hard to know what cut\sphinxhyphen{}off frequency to choose, either too low: removing part of the signal, or too high: keeping some unfiltered measurement noise in the data. The Kalman filter has a system model that continuously estimates the state of the system that is run in parallel with the measurement data. The filter estimates the current state as a combination of the measurement data and the system model estimate based on belief in the data and the model. If the data has low noise the estimate turns towards that data, if on the other hand the model gives very good predictions that estimate turns towards the model.

\sphinxAtStartPar
The inverse dynamics requires the entire states (positions, velocities and accelerations) of the system to be known. Only positions are known from the measurements which means that velocities and accelerations are hidden states that should be estimated by the EKF.
The state transition \(f(\mathbf{x},\mathbf{c})\) is taken from the VMM (\autoref{equation:02.01_VMMs:eqf}) to use the VMM as the EKF predictor.

\sphinxAtStartPar
The state of the system is observed (measured) with a linear observation model (\autoref{equation:04.01_EK:eqobserve}) where \(\mathbf{y}\) is the measured data \(\mathbf{H}\) is the observation matrix and \(\eta\) is measurement noise.
\begin{equation}\label{equation:04.01_EK:eqobserve}
\begin{split}\mathbf{y} = \mathbf{H} x + \eta\end{split}
\end{equation}
\sphinxAtStartPar
The EKF recursive algorithm used is summarized in pseudocode below.
\label{04.01_EK:ek-algorithm}
\begin{sphinxadmonition}{note}{Algorithm 3.1 (Discrete\sphinxhyphen{}time extended Kalman filter)}



\sphinxAtStartPar
\sphinxstylestrong{Inputs} Initial values: \(x_0\), \(P_0\), \(C_d\), \(R_d\), \(Q_d\), \(E_d\)

\sphinxAtStartPar
\sphinxstylestrong{Output} Estimated states: \(\hat{x}\), estimated state covariances \(\hat{P}\)
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Initial values:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumii}{enumiii}{}{.}%
\item {} 
\sphinxAtStartPar
\(\hat{x}[0] = x_0\)

\item {} 
\sphinxAtStartPar
\(\hat{P}[0] = P_0\)

\end{enumerate}

\item {} 
\sphinxAtStartPar
For \(k\) in \(n\) measurements (time steps)
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumii}{enumiii}{}{.}%
\item {} 
\sphinxAtStartPar
KF gain
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumiii}{enumiv}{}{.}%
\item {} 
\sphinxAtStartPar
\(K[k]=\hat{P}[k] C_d^T \left(C_d \hat{P}[k] C_d^T + R_d\right)^{-1}\)

\item {} 
\sphinxAtStartPar
\(I_{KC} = I_n - K[k] C_d\)

\end{enumerate}

\item {} 
\sphinxAtStartPar
Update
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumiii}{enumiv}{}{.}%
\item {} 
\sphinxAtStartPar
State corrector
\(\hat{x}[k] = \hat{x}[k] + K[k] (y - C_d \hat{x}[k]) \)

\item {} 
\sphinxAtStartPar
Covariance corrector
\(\hat{P}[k] = I_{KC} \cdot \hat{P}[k] I_{KC}^T + K[k] R_d K^T \)

\end{enumerate}

\item {} 
\sphinxAtStartPar
Predict
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumiii}{enumiv}{}{.}%
\item {} 
\sphinxAtStartPar
State predictor
\(\hat{x}[k+1] = \hat{x}[k] + h \cdot \hat{f}(\hat{x}[k], c[k])\)

\item {} 
\sphinxAtStartPar
Covariance predictor
\(\hat{P}[k+1] = A_d[k]  \hat{P}[k] A_d[k]^T + E_d Q_d E_d^T \)

\end{enumerate}

\end{enumerate}

\end{enumerate}
\end{sphinxadmonition}

\sphinxAtStartPar
where \(n\) is number of states (6 in this case), \(I_n\) is an \(n\) * \(n\) identity matrix.

\sphinxAtStartPar
The transition matrix is calculated for each iteration using a Jacobian of the transition model:
\begin{equation}\label{equation:04.01_EK:eqjacobi}
\begin{split}A_d[k] = I + h \left. \frac{\partial f \left(x[k],c[k] \right)}{\partial x[k]} \right|_{x[k]=\hat{x}[k]}\end{split}
\end{equation}
\sphinxAtStartPar
This part and the fact that the nonlinear transition model is used directly as the predictor are the extensions part of the EKF compared to the linear KF.

\sphinxAtStartPar
The output from the filter are the estimated states: \(\hat{x}\) and estimated state covariance matrix \(\hat{P}\). \(\hat{x}\) represent the most likely estimates, but the estimates have uncertainty that are expressed in \(\hat{P}\).

\sphinxAtStartPar
The state of the system is described by the ships position, heading, velocities and yaw velocity:
\begin{equation}\label{equation:04.01_EK:eqstates}
\begin{split}x = [x_0,y_0,\Psi,u,v,r]^T\end{split}
\end{equation}
\sphinxAtStartPar
The initial state \(x_0\) is taken as the mean value of the first five measurements, where the velocities are estimated with numeric differentiation.

\sphinxAtStartPar
\(C_d\) selects the measured states (\(x_0\), \(y_0\), \(\Psi\)):
\begin{equation}\label{equation:04.01_EK:eqcd}
\begin{split}\displaystyle C_{d} = h \left[\begin{matrix}1 & 0 & 0 & 0 & 0 & 0\\0 & 1 & 0 & 0 & 0 & 0\\0 & 0 & 1 & 0 & 0 & 0\end{matrix}\right]\end{split}
\end{equation}
\sphinxAtStartPar
\(E_d\) selects the hidden states (\(u\), \(v\),\(r\)):
\begin{equation}\label{equation:04.01_EK:eqed}
\begin{split}\displaystyle E_{d} = h \left[\begin{matrix}0 & 0 & 0\\0 & 0 & 0\\0 & 0 & 0\\1 & 0 & 0\\0 & 1 & 0\\0 & 0 & 1\end{matrix}\right]\end{split}
\end{equation}
\sphinxAtStartPar
Where \(h\) is the discrete time step.

\sphinxAtStartPar
\(R_d\) describes the covariance matrix of the measurement, \(Q_d\) is the covariance matrix of the process model. \(P_0\) is the initial state covariance.
Selecting good values for these three matrixes is the tricky part in getting the EKF to work well. The amount of expected measurement noise in the data should be inserted in to \(R_d\) and the amount of error generated by the process model (VMM) needs to be estimated in \(Q_d\). The choices for these matrixes very much depend on the belief in the present data and the present process model.


\subsubsection{Rauch Tung Striebel (RTS) smoother}
\label{\detokenize{04.01_EK:rauch-tung-striebel-rts-smoother}}\label{\detokenize{04.01_EK:rts}}
\sphinxAtStartPar
The EKF is recursive and can be run online, continuously making new estimates as new measurements arrive. The EKF uses passed measurements to estimate states in the near future. This is useful for applications like autopilots. For the PIT on already existing data, this is an unnecessary restriction where a whole time series of existing measurements is available. The fact that both past and future data is known can be used to improve the filter. An EKF filter can be allowed to include future time steps in the filtering by adding a smoother after the filter. The PIT uses a Rauch Tung Striebel (RTS) smoother {[}\hyperlink{cite.bibligraphy:id67}{RST65}{]}, which is an algorithm that runs the EKF backwards to also account for future time steps.

\sphinxAtStartPar
The EKF and RTS have been run on simulated data with Gaussian noise added, to see if the real states can be identified. Results from this can be seen in  \hyperref[\detokenize{04.01_EK:fig-ekf}]{Fig.\@ \ref{\detokenize{04.01_EK:fig-ekf}}}. This shows that the RTS smoother is needed to also get an accurate estimate of the yaw acceleration.

\begin{figure}[H]
\centering
\capstart

\noindent\sphinxincludegraphics{{d8c65cd8babe257a32c7f77a44a59be2315ee1102e37abc0883fb7309652e255}.pdf}
\caption{EKF and RTS on simulated data (real) with Gaussian noise added (raw).}\label{\detokenize{04.01_EK:fig-ekf}}\end{figure}


\section{Case studies}
\label{\detokenize{05.01_case_studies:case-studies}}\label{\detokenize{05.01_case_studies:id1}}\label{\detokenize{05.01_case_studies::doc}}
\sphinxAtStartPar
Two case study model test results, i.e., the wPCC as in \hyperref[\detokenize{05.01_case_studies:wpcc-mdl}]{Fig.\@ \ref{\detokenize{05.01_case_studies:wpcc-mdl}}} and the well\sphinxhyphen{}known KVLCC2, are used to validate the proposed PIT method to obtain the hydrodynamic derivatives of the VMMs to describe a ship’s manoeuverability. The general aim with developing a VMM with PIT is to be able to make predictions for unseen data, outside the known data from model tests or full scale operation. The aim with both test cases is therefore to predict turning circle manouvres with VMMs that are trained on model tests data where turning circle manoeuvres are excluded. The training data contains drift angles and yaw rates that are much smaller than what is encountered during a turning circle manoeuvre.
The main dimensions of the two case study ship models are listed in \hyperref[\detokenize{05.01_case_studies:main-dimensions-of-test-case-ship-models}]{Table \ref{\detokenize{05.01_case_studies:main-dimensions-of-test-case-ship-models}}}. The wPCC is a wind powered car carrier tested at SSPA {[}\hyperlink{cite.bibligraphy:id86}{Ale22}{]}. This twin\sphinxhyphen{}screw ship with large rudders has good course stability and is expected to have almost linear and symmetric hydrodynamic manoeuvring forces. The test setup and measurement procedures at SSPA is also well known to the authors which all in all makes it ideal as a first test case of the PIT.
The KVLCC2 model test data from HSVA and MARIN was made available from SIMMAN2008 conference {[}\hyperlink{cite.bibligraphy:id79}{SAK+11}{]}. This single screw ship is more course unstable than the wPCC test case and is therefore expected to have more nonlinear hydrodynamic manoeuvring forces which are also unsymmetrical due to the single propeller. This makes it good as the seconds test case with PIT on a more nonlinear and unsymmetrical model.

\begin{figure}[H]
\centering
\capstart

\noindent\sphinxincludegraphics[height=150\sphinxpxdimen]{{wpcc_mdl}.png}
\caption{wPCC tested at SSPA. Copyright 2020 by SSPA Sweden AB.}\label{\detokenize{05.01_case_studies:wpcc-mdl}}\end{figure}


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxthecaptionisattop
\sphinxcaption{Main dimensions of test case ship models}\label{\detokenize{05.01_case_studies:main-dimensions-of-test-case-ship-models}}
\sphinxaftertopcaption
\begin{tabulary}{\linewidth}[t]{|T|T|T|T|T|T|T|T|T|T|T|T|T|T|}
\hline
\sphinxstyletheadfamily &\sphinxstyletheadfamily 
\sphinxAtStartPar
\(B\) \([m]\)
&\sphinxstyletheadfamily 
\sphinxAtStartPar
\(D\) \([m]\)
&\sphinxstyletheadfamily 
\sphinxAtStartPar
\(L\) \([m]\)
&\sphinxstyletheadfamily 
\sphinxAtStartPar
\(L_{CG}\) \([m]\)
&\sphinxstyletheadfamily 
\sphinxAtStartPar
\(N_p\)
&\sphinxstyletheadfamily 
\sphinxAtStartPar
\(T\) \([m]\)
&\sphinxstyletheadfamily 
\sphinxAtStartPar
\(\alpha\)
&\sphinxstyletheadfamily 
\sphinxAtStartPar
\(\nabla\) \([m^3]\)
&\sphinxstyletheadfamily 
\sphinxAtStartPar
\(k_{zz}\)
&\sphinxstyletheadfamily 
\sphinxAtStartPar
\(m\) \([kg]\)
&\sphinxstyletheadfamily 
\sphinxAtStartPar
\(w_{p0}\)
&\sphinxstyletheadfamily 
\sphinxAtStartPar
\(x_{p}\) \([m]\)
&\sphinxstyletheadfamily 
\sphinxAtStartPar
\(x_{r}\) \([m]\)
\\
\hline
\sphinxAtStartPar
WPCC
&
\sphinxAtStartPar
0.95
&
\sphinxAtStartPar
0.12
&
\sphinxAtStartPar
5.01
&
\sphinxAtStartPar
0.0
&
\sphinxAtStartPar
2
&
\sphinxAtStartPar
0.21
&
\sphinxAtStartPar
41.2
&
\sphinxAtStartPar
0.44
&
\sphinxAtStartPar
0.25
&
\sphinxAtStartPar
441
&
\sphinxAtStartPar
0.15
&
\sphinxAtStartPar
\sphinxhyphen{}2.42
&
\sphinxAtStartPar
\sphinxhyphen{}2.42
\\
\hline
\sphinxAtStartPar
KVLCC2 (HSVA)
&
\sphinxAtStartPar
1.27
&
\sphinxAtStartPar
0.2
&
\sphinxAtStartPar
7.0
&
\sphinxAtStartPar
0.24
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0.46
&
\sphinxAtStartPar
45.7
&
\sphinxAtStartPar
3.27
&
\sphinxAtStartPar
0.25
&
\sphinxAtStartPar
3272
&
\sphinxAtStartPar
0.4
&
\sphinxAtStartPar
\sphinxhyphen{}3.39
&
\sphinxAtStartPar
\sphinxhyphen{}3.5
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
The PIT method requires an initial guessed linear VMM. For these initial models for the two test cases, their hydrodynamic derivatives are calculated with semi empirical formulas (\autoref{equation:05.01_case_studies:eqnr}\sphinxhyphen{}\autoref{equation:05.01_case_studies:eqyvdot}) taken from {[}\hyperlink{cite.bibligraphy:id45}{Bri93}{]} and shown in table \hyperref[\detokenize{05.01_case_studies:intial-guess}]{Table \ref{\detokenize{05.01_case_studies:intial-guess}}}.
\begin{equation}\label{equation:05.01_case_studies:eqnr}
\begin{split}\displaystyle N_{r} = - \frac{\pi T^{2} \left(\frac{0.039 B}{T} - \frac{0.56 B}{L} + 0.25\right)}{L^{2}}\end{split}
\end{equation}\begin{equation}\label{equation:05.01_case_studies:eqnrdot}
\begin{split}\displaystyle N_{\dot{r}} = - \frac{\pi T^{2} \left(\frac{0.017 B CB}{T} - \frac{0.33 B}{L} + 0.0833333333333333\right)}{L^{2}}\end{split}
\end{equation}\begin{equation}\label{equation:05.01_case_studies:eqnv}
\begin{split}\displaystyle N_{v} = - \frac{\pi T^{2} \left(0.5 + \frac{2.4 T}{L}\right)}{L^{2}}\end{split}
\end{equation}\begin{equation}\label{equation:05.01_case_studies:eqnvdot}
\begin{split}\displaystyle N_{\dot{v}} = - \frac{\pi T^{2} \left(- \frac{0.04 B}{T} + \frac{1.1 B}{L}\right)}{L^{2}}\end{split}
\end{equation}\begin{equation}\label{equation:05.01_case_studies:eqxudot}
\begin{split}\displaystyle X_{\dot{u}} = \frac{2.0 m}{L^{3} \rho \left(\pi \sqrt{\frac{L^{3}}{volume}} - 14\right)}\end{split}
\end{equation}\begin{equation}\label{equation:05.01_case_studies:eqyr}
\begin{split}\displaystyle Y_{r} = - \frac{\pi T^{2} \left(- \frac{0.08 B}{T} + \frac{2.2 B}{L} - 0.5\right)}{L^{2}}\end{split}
\end{equation}\begin{equation}\label{equation:05.01_case_studies:eqyrdot}
\begin{split}\displaystyle Y_{\dot{r}} = - \frac{\pi T^{2} \left(- \frac{0.0033 B^{2}}{T^{2}} + \frac{0.67 B}{L}\right)}{L^{2}}\end{split}
\end{equation}\begin{equation}\label{equation:05.01_case_studies:eqyv}
\begin{split}\displaystyle Y_{v} = - \frac{\pi T^{2} \left(\frac{0.4 B CB}{T} + 1\right)}{L^{2}}\end{split}
\end{equation}\begin{equation}\label{equation:05.01_case_studies:eqyvdot}
\begin{split}\displaystyle Y_{\dot{v}} = - \frac{\pi T^{2} \left(- \frac{5.1 B^{2}}{L^{2}} + \frac{0.16 B CB}{T} + 1\right)}{L^{2}}\end{split}
\end{equation}

\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxthecaptionisattop
\sphinxcaption{Initial guessed derivatives in linear models (times 1000)}\label{\detokenize{05.01_case_studies:intial-guess}}
\sphinxaftertopcaption
\begin{tabulary}{\linewidth}[t]{|T|T|T|T|T|T|T|T|T|T|T|T|}
\hline
\sphinxstyletheadfamily &\sphinxstyletheadfamily 
\sphinxAtStartPar
\( N_{\delta} \)
&\sphinxstyletheadfamily 
\sphinxAtStartPar
\( N_{r} \)
&\sphinxstyletheadfamily 
\sphinxAtStartPar
\( N_{\dot{r}} \)
&\sphinxstyletheadfamily 
\sphinxAtStartPar
\( N_{v} \)
&\sphinxstyletheadfamily 
\sphinxAtStartPar
\( N_{\dot{v}} \)
&\sphinxstyletheadfamily 
\sphinxAtStartPar
\( X_{\dot{u}} \)
&\sphinxstyletheadfamily 
\sphinxAtStartPar
\( Y_{\delta} \)
&\sphinxstyletheadfamily 
\sphinxAtStartPar
\( Y_{r} \)
&\sphinxstyletheadfamily 
\sphinxAtStartPar
\( Y_{\dot{r}} \)
&\sphinxstyletheadfamily 
\sphinxAtStartPar
\( Y_{v} \)
&\sphinxstyletheadfamily 
\sphinxAtStartPar
\( Y_{\dot{v}} \)
\\
\hline
\sphinxAtStartPar
WPCC
&
\sphinxAtStartPar
\sphinxhyphen{}1.5
&
\sphinxAtStartPar
\sphinxhyphen{}1.719
&
\sphinxAtStartPar
\sphinxhyphen{}0.299
&
\sphinxAtStartPar
\sphinxhyphen{}3.184
&
\sphinxAtStartPar
\sphinxhyphen{}0.128
&
\sphinxAtStartPar
0.179
&
\sphinxAtStartPar
3.0
&
\sphinxAtStartPar
2.402
&
\sphinxAtStartPar
\sphinxhyphen{}0.303
&
\sphinxAtStartPar
\sphinxhyphen{}9.713
&
\sphinxAtStartPar
\sphinxhyphen{}6.109
\\
\hline
\sphinxAtStartPar
KVLCC2 (HSVA)
&
\sphinxAtStartPar
\sphinxhyphen{}1.5
&
\sphinxAtStartPar
\sphinxhyphen{}3.415
&
\sphinxAtStartPar
\sphinxhyphen{}0.822
&
\sphinxAtStartPar
\sphinxhyphen{}8.707
&
\sphinxAtStartPar
\sphinxhyphen{}1.166
&
\sphinxAtStartPar
1.05
&
\sphinxAtStartPar
3.0
&
\sphinxAtStartPar
4.305
&
\sphinxAtStartPar
\sphinxhyphen{}1.271
&
\sphinxAtStartPar
\sphinxhyphen{}25.266
&
\sphinxAtStartPar
\sphinxhyphen{}15.846
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\subsection{wPCC test scenarios}
\label{\detokenize{05.01_case_studies:wpcc-test-scenarios}}
\sphinxAtStartPar
For the wPCC test case, the capability of the proposed PIT method to build a VMM is verified by a turning circle manoeuvre, i.e., if the VMM built by the proposed method based on a series of model tests including ZigZag10/10, 20/20 to port and starboard as well as self propulsion and yaw rate tests can predict the turning circle manoeuvre. The turning circle test contains much larger drift angles, rudder angle and yaw rates compared to the model tests used for training, so that the VMMs prediction ability outside the training data is tested.
The wPCC test case focuses on the prediction of forces and moments from the ship hull and rudders. The propeller force is therefore not part of the prediction model and is instead taken from the model test measurements.
The model test data used for modelling is split into a training and validation datasets. The training dataset contains self propulsion, yaw rate tests and zigzag10/10 tests to starboard and port. The validation dataset consists of three zigzag20/20 tests, so that the validation set contains larger drift angles, rudder angles and yaw rates than the training set in a similar way as for the real prediction case. The training and validation datasets as well as the turning circle test are shown in \hyperref[\detokenize{05.01_case_studies:fig-traintest}]{Fig.\@ \ref{\detokenize{05.01_case_studies:fig-traintest}}}.

\begin{figure}[H]
\centering
\capstart

\noindent\sphinxincludegraphics{{1e8a1cc491942ce4c37d053e1aeb3a28762fb8b3a5a8a4c6fcec12603dd0bbc6}.pdf}
\caption{wPCC training, validation and testing datasets.}\label{\detokenize{05.01_case_studies:fig-traintest}}\end{figure}


\subsection{KVLCC2 test scenarios}
\label{\detokenize{05.01_case_studies:kvlcc2-test-scenarios}}
\sphinxAtStartPar
The verification of the proposed method is also performed using the KVLCC2 case study ship model. It is to demonstrate that a turning circle manoeuvre should be predicted by the VMM by the PIT method based on a series of model tests carried out at HSVA for the SIMMAN2008 conference {[}\hyperlink{cite.bibligraphy:id79}{SAK+11}{]}. The turning circle test contains much larger drift angles, rudder angle and yaw rates compared to the model tests used for training, so that
the VMM:s prediction ability outside the training data is tested.
The propeller is part of the VMM for this test case, instead of only hull and rudders as in the wPCC test case so that the full ship can be simulated without any additional input.
The model test data that is used for training is split into a training and validation dataset. The training dataset contains various zigzag tests to startboard and port. The validation dataset consists of a ZigZag35/5 test, so that the validation set contains larger drift angles, rudder angles and yaw rates than the training set in a similar way as for the real prediction case. The test set is taken from turning circle model tests carried out at MARIN for the SIMMAN2008 conference {[}\hyperlink{cite.bibligraphy:id79}{SAK+11}{]}. The training and validation datasets as well as the test set are shown in \hyperref[\detokenize{05.01_case_studies:fig-kvlcc2-traintest}]{Fig.\@ \ref{\detokenize{05.01_case_studies:fig-kvlcc2-traintest}}}.

\begin{figure}[H]
\centering
\capstart

\noindent\sphinxincludegraphics{{f4ffb590c57980013b43152c6519c47d284162d10bbc366c500324350de53977}.pdf}
\caption{KVLCC2 training, validation and testing datasets.}\label{\detokenize{05.01_case_studies:fig-kvlcc2-traintest}}\end{figure}


\section{Results}
\label{\detokenize{06.01_results:results}}\label{\detokenize{06.01_results:id1}}\label{\detokenize{06.01_results::doc}}

\subsection{Inverse dynamics}
\label{\detokenize{06.40_results_inverse_dynamics:inverse-dynamics}}\label{\detokenize{06.40_results_inverse_dynamics::doc}}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_remove_input}
\end{sphinxuseclass}
\end{sphinxuseclass}
The hydrodynamic derivatives within the VMM can be identified exactly at ideal conditions for the PIT with no measurement noise and a perfect estimator. For example, artificial data from a turning circle test can be simulated by a pre-defined/true VMM and then the hydrodynamic derivatives within the VMM can be identified with exact the same values. Results from such a simulation is shown in \hyperref[\detokenize{06.40_results_inverse_dynamics:fig-bar-parameters}]{Fig.\@ \ref{\detokenize{06.40_results_inverse_dynamics:fig-bar-parameters}}} where the regression has identified the true values perfectly.

\begin{figure}[H]
\centering
\capstart

\noindent\sphinxincludegraphics{{203fc0f2875e67ae4f812e5dd36dbfa44927591bc34b2bd0563513a33d7602ad}.pdf}
\caption{True and regressed hydrodynamic derivatives in MAVMM identified with Inverse dynamics and OLS regression on a simulated turning circle with MAVMM.}\label{\detokenize{06.40_results_inverse_dynamics:fig-bar-parameters}}\end{figure}


\subsection{Preprocessor}
\label{\detokenize{06.31_results_noise:preprocessor}}\label{\detokenize{06.31_results_noise::doc}}
\sphinxAtStartPar
Instead of the EKF which the proposed PIT uses, the low\sphinxhyphen{}pass filter is very common choice to preprocess the model test data.
In order to study which of the filters that works the best, the proposed PIT has been run on the wPCC model test data with the EKF + RTS smoother replaced by a Low\sphinxhyphen{}pass filter instead. The low\sphinxhyphen{}pass filter applies a first order linear digital Butterworth filter twice, once forward and once backwards, to get zero phase {[}\hyperlink{cite.bibligraphy:id83}{VGO+20}{]}. \hyperref[\detokenize{06.31_results_noise:fig-lowpass-accuracy}]{Fig.\@ \ref{\detokenize{06.31_results_noise:fig-lowpass-accuracy}}} shows the average simulation error \( {RMSE} \) with low\sphinxhyphen{}pass filters at various cutt off frequencies for all wPCC model tets. Corresponding error with PIT using EKF + RTS is also shown in the figure. The simulation error for each model test is expressed as Root Mean Square Error \(RMSE\) (\autoref{equation:06.31_results_noise:eqrmse}) of the distance between the position from the model test and simulation.
\begin{equation}\label{equation:06.31_results_noise:eqrmse}
\begin{split}RMSE=\sqrt{ \frac{\sum_{n=1}^{N} (d_n^2) }{N}} \end{split}
\end{equation}
\sphinxAtStartPar
where \(d_n\) is the euclidean distance for each time step between the model test positions (\(x_0\), \(y_0\)) and the predicted positions.

\begin{figure}[H]
\centering
\capstart

\noindent\sphinxincludegraphics{{dcffa991be41f550a2ba5e4a5f7fc829dc33a12a115491dbefb5152401ca8853}.pdf}
\caption{Average simulation error with MAVMM fitted on wPCC model test data using low\sphinxhyphen{}pass filters with various cutt off frequency or EKF.}\label{\detokenize{06.31_results_noise:fig-lowpass-accuracy}}\end{figure}

\sphinxAtStartPar
Even though high accuracy can be obtained using a low\sphinxhyphen{}pass filter as the pre-processor if an optimal cut off frequency is selected, its accuracy decreases quickly at lower or higher frequencies. With higher cut-off frequencies too much of the measurement error remains in the data (having no filter at all is the extreme case), with poor performance of the OLS regression. Too low cut off frequency on the other hand, removes too much, also removing parts of the true signal. The low\sphinxhyphen{}pass filter with 7 Hz cut off frequency has the lowest error between the low\sphinxhyphen{}pass filters, but EKF + RTS in the PIT has even lower error.


\subsection{wPCC tests}
\label{\detokenize{06.10_results_wpcc:wpcc-tests}}\label{\detokenize{06.10_results_wpcc::doc}}
\sphinxAtStartPar
Large problems with multicolliearity was encountered when applying the PIT method to get the AVMM based on the wPCC data. The absolute correlation coefficient between the features in the wPCC yaw moment regression are shown in \hyperref[\detokenize{06.10_results_wpcc:fig-ncorr}]{Fig.\@ \ref{\detokenize{06.10_results_wpcc:fig-ncorr}}}. It can be seen that most of the coefficients have very high absolute correlation (indicated in black). Some of the regressed hydrodynamic derivatives in the AVMM also have very large values and large uncertainty. Therefore, the modified model, i.e., the MAVMM, is proposed to further improve the model and the method.

\begin{figure}[H]
\centering
\capstart

\noindent\sphinxincludegraphics{{eb7b600e63201b670217b2c3bcc100a157dc84dc216720bb54e8e528415b80ca}.pdf}
\caption{Absolute correlation between the features in the wPCC yaw moment regression of AVMM}\label{\detokenize{06.10_results_wpcc:fig-ncorr}}\end{figure}

\sphinxAtStartPar
The mean values and standard error (se) of the hydrodynamic derivatives expressed with prime units for wPCC obtained with PIT applied on the MAVMM (\autoref{equation:02.01_VMMs:eqxmartinssimple},\autoref{equation:02.01_VMMs:eqymartinssimple}, \autoref{equation:02.01_VMMs:eqnmartinssimple}) are shown in \hyperref[\detokenize{06.10_results_wpcc:wpcc-derivatives}]{Table \ref{\detokenize{06.10_results_wpcc:wpcc-derivatives}}}. The standard error is much smaller for this model compared to AVMM.


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxthecaptionisattop
\sphinxcaption{wPCC MAVMM derivatives (times 1000)}\label{\detokenize{06.10_results_wpcc:wpcc-derivatives}}
\sphinxaftertopcaption
\begin{tabulary}{\linewidth}[t]{|T|T|T|T|T|T|T|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
name
&\sphinxstyletheadfamily 
\sphinxAtStartPar
mean
&\sphinxstyletheadfamily 
\sphinxAtStartPar
se
&\sphinxstyletheadfamily 
\sphinxAtStartPar
name
&\sphinxstyletheadfamily 
\sphinxAtStartPar
mean
&\sphinxstyletheadfamily 
\sphinxAtStartPar
se
&\sphinxstyletheadfamily 
\sphinxAtStartPar
name
&\sphinxstyletheadfamily 
\sphinxAtStartPar
mean
&\sphinxstyletheadfamily 
\sphinxAtStartPar
se
\\
\hline
\sphinxAtStartPar
\( X_{\delta\delta} \)
&
\sphinxAtStartPar
\sphinxhyphen{}2.927
&
\sphinxAtStartPar
0.011
&
\sphinxAtStartPar
\( Y_{ur} \)
&
\sphinxAtStartPar
\sphinxhyphen{}65.507
&
\sphinxAtStartPar
0.082
&
\sphinxAtStartPar
\( N_{\delta} \)
&
\sphinxAtStartPar
\sphinxhyphen{}1.993
&
\sphinxAtStartPar
0.002
\\
\hline
\sphinxAtStartPar
\( X_{vr} \)
&
\sphinxAtStartPar
\sphinxhyphen{}7.737
&
\sphinxAtStartPar
0.066
&
\sphinxAtStartPar
\( Y_{v} \)
&
\sphinxAtStartPar
\sphinxhyphen{}20.347
&
\sphinxAtStartPar
0.016
&
\sphinxAtStartPar
\( N_{T\delta} \)
&
\sphinxAtStartPar
\sphinxhyphen{}5.392
&
\sphinxAtStartPar
0.599
\\
\hline
\sphinxAtStartPar
\( X_{rr} \)
&
\sphinxAtStartPar
\sphinxhyphen{}1.413
&
\sphinxAtStartPar
0.026
&
\sphinxAtStartPar
\( Y_{u} \)
&
\sphinxAtStartPar
\sphinxhyphen{}0.027
&
\sphinxAtStartPar
0.001
&
\sphinxAtStartPar
\( N_{r} \)
&
\sphinxAtStartPar
\sphinxhyphen{}37.341
&
\sphinxAtStartPar
0.096
\\
\hline
\sphinxAtStartPar
\( X_{uu} \)
&
\sphinxAtStartPar
20.124
&
\sphinxAtStartPar
0.137
&
\sphinxAtStartPar
\( Y_{r} \)
&
\sphinxAtStartPar
64.14
&
\sphinxAtStartPar
0.083
&
\sphinxAtStartPar
\( N_{u} \)
&
\sphinxAtStartPar
\sphinxhyphen{}0.003
&
\sphinxAtStartPar
0.0
\\
\hline
\sphinxAtStartPar
\( X_{u} \)
&
\sphinxAtStartPar
\sphinxhyphen{}20.948
&
\sphinxAtStartPar
0.137
&&&&
\sphinxAtStartPar
\( N_{ur} \)
&
\sphinxAtStartPar
35.525
&
\sphinxAtStartPar
0.096
\\
\hline&&&&&&
\sphinxAtStartPar
\( N_{v} \)
&
\sphinxAtStartPar
\sphinxhyphen{}0.05
&
\sphinxAtStartPar
0.004
\\
\hline&&&&&&
\sphinxAtStartPar
\( N_{vv\delta} \)
&
\sphinxAtStartPar
\sphinxhyphen{}19.051
&
\sphinxAtStartPar
0.054
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
Forces and moment predicted with the VMMs fitted on the training set are show in \hyperref[\detokenize{06.10_results_wpcc:fig-validation-forces}]{Fig.\@ \ref{\detokenize{06.10_results_wpcc:fig-validation-forces}}}. It can be seen that the fitted AVMM overpredicts the forces by far due to the anticipated extrapolation error. Simulations of the validation cases are therefore only possible by the MAVMM. The simulations are shown for one of the ZigZag20/20 validation cases in \hyperref[\detokenize{06.10_results_wpcc:fig-validation-sim}]{Fig.\@ \ref{\detokenize{06.10_results_wpcc:fig-validation-sim}}}.

\begin{figure}[H]
\centering
\capstart

\noindent\sphinxincludegraphics{{a58975f679830ffa2c1d6652c1eda6bab28e21366a74205f823bf40e4457c849}.pdf}
\caption{Validation of force models for wPCC ZigZag20/20.}\label{\detokenize{06.10_results_wpcc:fig-validation-forces}}\end{figure}

\begin{figure}[H]
\centering
\capstart

\noindent\sphinxincludegraphics{{4a724e93ef4a4403ee83f5140250a26ee3880aa3f5eb85957a0f904239bcecb2}.pdf}
\caption{Validation with simulations for wPCC ZigZag20/20.}\label{\detokenize{06.10_results_wpcc:fig-validation-sim}}\end{figure}

\sphinxAtStartPar
For the wPCC the prediction was conducted using simulation of the turning circle by the trained MAVMM, and the prediction results are presented in \hyperref[\detokenize{06.10_results_wpcc:fig-track-plot-testing-sim}]{Fig.\@ \ref{\detokenize{06.10_results_wpcc:fig-track-plot-testing-sim}}}, \hyperref[\detokenize{06.10_results_wpcc:fig-testing-sim}]{Fig.\@ \ref{\detokenize{06.10_results_wpcc:fig-testing-sim}}}. Monte Carlo simulations with alternative realizations of the regression are also shown in these figures. The alternative realizations considering the uncertainty in the regressed parameters have similar simulation results to the model with mean values of the regression (black line). 
Advance and tactical diameter {[}\hyperlink{cite.bibligraphy:id16}{IMO02}{]} differs 4\% and 1\% between simulation with the VMM and corresponding results from the model tests \hyperref[\detokenize{06.10_results_wpcc:tab-wpcc-advance}]{Table \ref{\detokenize{06.10_results_wpcc:tab-wpcc-advance}}}.

\begin{figure}[H]
\centering
\capstart

\noindent\sphinxincludegraphics{{ddb34ffa861d670f6b962dbccf038bc83cf50f7bd662c99369f695f8e46e3a33}.pdf}
\caption{Turning circle test case for wPCC, track plots from model test and simulation.}\label{\detokenize{06.10_results_wpcc:fig-track-plot-testing-sim}}\end{figure}

\begin{figure}[H]
\centering
\capstart

\noindent\sphinxincludegraphics{{d4695c42ccd80c54ffe073c9175ed28a672016f47888e99f04bef17ca7d934b5}.pdf}
\caption{Turning circle test case for wPCC, time series from model test and simulation.}\label{\detokenize{06.10_results_wpcc:fig-testing-sim}}\end{figure}


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxthecaptionisattop
\sphinxcaption{wPCC Predicted turning circle advance and tactical diameter compared to SSPA model tests and IMO limit}\label{\detokenize{06.10_results_wpcc:tab-wpcc-advance}}
\sphinxaftertopcaption
\begin{tabulary}{\linewidth}[t]{|T|T|T|T|T|}
\hline
\sphinxstyletheadfamily &\sphinxstyletheadfamily 
\sphinxAtStartPar
Advance {[}m{]}
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Advance (IMO) {[}m{]}
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Tactical diameter {[}m{]}
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Tactical diameter (IMO) {[}m{]}
\\
\hline
\sphinxAtStartPar
Model test
&
\sphinxAtStartPar
12.82
&
\sphinxAtStartPar
22.57
&
\sphinxAtStartPar
14.76
&
\sphinxAtStartPar
25.07
\\
\hline
\sphinxAtStartPar
Prediction
&
\sphinxAtStartPar
13.3
&
\sphinxAtStartPar
22.57
&
\sphinxAtStartPar
14.93
&
\sphinxAtStartPar
25.07
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\subsection{KVLCC2 tests}
\label{\detokenize{06.20_results_kvlcc2:kvlcc2-tests}}\label{\detokenize{06.20_results_kvlcc2::doc}}

\subsubsection{KVLCC2 propeller model}
\label{\detokenize{06.20_results_kvlcc2:kvlcc2-propeller-model}}
\sphinxAtStartPar
The coefficients of \(K_T\) (\autoref{equation:02.10_propeller_model:eqkt}) were regressed from the KVLCC2 propeller characteristics from SIMMAN2008 HSVA model tests {[}\hyperlink{cite.bibligraphy:id79}{SAK+11}{]} (\(k_0\):\DUrole{output,text_plain}{0.32419}, \(k_1\):\DUrole{output,text_plain}{\sphinxhyphen{}0.22091}, \(k_2\):\DUrole{output,text_plain}{\sphinxhyphen{}0.14905}).
The Polynomial propeller model was developed with polynomial regression and cross validation on the training and validation datasets, to make the best feature selection.
A cross validation study on the three candidate propeller models: MMG propeller model, Simple propeller model and the Polynomial propeller model were carried out. The training set as well as the validation set was made up by entire model test time series from the HSVA model tests.
The model tests were divided into the test and validation set randomly. The random train and validation was repeated 100 times. The Polynomial model was selected, having the highest accuracy. Taylor wake \(w_{p0}\) = \DUrole{output,text_plain}{0.4} was used in all three models, the MMG model used \(C_1\)=\DUrole{output,text_plain}{2.0}, \(C_2\)=\DUrole{output,text_plain}{1.6} when \(\beta_p>0\) and \(C_2\)=\DUrole{output,text_plain}{1.1} when \(\beta_p<=0\) {[}\hyperlink{cite.bibligraphy:id22}{YY15}{]}. \hyperref[\detokenize{06.20_results_kvlcc2:fig-propeller-validation}]{Fig.\@ \ref{\detokenize{06.20_results_kvlcc2:fig-propeller-validation}}} shows a small part of the cross validation.

\begin{figure}[H]
\centering
\capstart

\noindent\sphinxincludegraphics{{fig_propeller_validation}.pdf}
\caption{Validation of MMG, Simple and Poynomial propeller models for KVLCC2.}\label{\detokenize{06.20_results_kvlcc2:fig-propeller-validation}}\end{figure}

\hyperref[\detokenize{06.20_results_kvlcc2:id3}]{Table \ref{\detokenize{06.20_results_kvlcc2:id3}}} shows coefficients of the the polynomial propeller model fitted on the training and validation dataset for KVLCC2.


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxthecaptionisattop
\sphinxcaption{KVLCC2 propeller model}\label{\detokenize{06.20_results_kvlcc2:id3}}
\sphinxaftertopcaption
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily &\sphinxstyletheadfamily 
\sphinxAtStartPar
\(\beta_p>0\)
&\sphinxstyletheadfamily 
\sphinxAtStartPar
\(\beta_p<=0\)
\\
\hline
\sphinxAtStartPar
\(C_1\)
&
\sphinxAtStartPar
\sphinxhyphen{}0.1735
&
\sphinxAtStartPar
\sphinxhyphen{}0.1066
\\
\hline
\sphinxAtStartPar
\(C_2\)
&
\sphinxAtStartPar
0.4589
&
\sphinxAtStartPar
0.0771
\\
\hline
\sphinxAtStartPar
\(C_3\)
&
\sphinxAtStartPar
\sphinxhyphen{}1.8865
&
\sphinxAtStartPar
1.2958
\\
\hline
\sphinxAtStartPar
\(C_4\)
&
\sphinxAtStartPar
0.0515
&
\sphinxAtStartPar
0.0514
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\subsubsection{KVLCC2 VMM}
\label{\detokenize{06.20_results_kvlcc2:kvlcc2-vmm}}
\sphinxAtStartPar
Forces and moment applied on the hull, rudder and propeller predicted with the VMMs fitted on the training set are show in \hyperref[\detokenize{06.20_results_kvlcc2:fig-kvlcc2-validation-forces}]{Fig.\@ \ref{\detokenize{06.20_results_kvlcc2:fig-kvlcc2-validation-forces}}}.
Simulations of the validation cases where only possible with the MAVMM as shown for one of the ZigZag20/20 validation cases in \hyperref[\detokenize{06.20_results_kvlcc2:fig-kvlcc2-validation-sim}]{Fig.\@ \ref{\detokenize{06.20_results_kvlcc2:fig-kvlcc2-validation-sim}}}. The predicted thrust is also shown in this figure.

\begin{figure}[H]
\centering
\capstart

\noindent\sphinxincludegraphics{{aba5c69c270f073de8763b8db7f108900cc8a7c58b7b4fa51ed79451393e9919}.pdf}
\caption{Validation of force models for KVLCC2.}\label{\detokenize{06.20_results_kvlcc2:fig-kvlcc2-validation-forces}}\end{figure}

\begin{figure}[H]
\centering
\capstart

\noindent\sphinxincludegraphics{{d7aa6c1d81a1b5e428d17144a9bb42bfaa1b9b10efcb2e9d2e92560b2f928019}.pdf}
\caption{Validation with simulations for KVLCC2.}\label{\detokenize{06.20_results_kvlcc2:fig-kvlcc2-validation-sim}}\end{figure}

\sphinxAtStartPar
Results from the final prediction of the turning circle test are shown in \hyperref[\detokenize{06.20_results_kvlcc2:fig-kvlcc2-testing-sim}]{Fig.\@ \ref{\detokenize{06.20_results_kvlcc2:fig-kvlcc2-testing-sim}}}. The prediction is conducted using simulation with the MAVMM trained on the training and validation dataset. Monte Carlo simulations with alternative realizations of the regression are also shown in this figure. The alternative realizations are very similar to the model with mean values of the regression (black line), since the standard deviation of the regressed parameters are very small (\hyperref[\detokenize{06.20_results_kvlcc2:kvlcc2-derivatives}]{Table \ref{\detokenize{06.20_results_kvlcc2:kvlcc2-derivatives}}}).

\begin{figure}[H]
\centering
\capstart

\noindent\sphinxincludegraphics{{5caddc603cc531984112f2389ed25aff0d3ef5b1618f056ba56beb92ad6b7871}.pdf}
\caption{Comparison between predicted Turning circle test with MAVMM trained on HSVA data and MARIN model test results for KVLCC2.}\label{\detokenize{06.20_results_kvlcc2:fig-kvlcc2-testing-sim}}\end{figure}


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxthecaptionisattop
\sphinxcaption{KVLCC2 MAVMM derivatives (times 1000)}\label{\detokenize{06.20_results_kvlcc2:kvlcc2-derivatives}}
\sphinxaftertopcaption
\begin{tabulary}{\linewidth}[t]{|T|T|T|T|T|T|T|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
name
&\sphinxstyletheadfamily 
\sphinxAtStartPar
mean
&\sphinxstyletheadfamily 
\sphinxAtStartPar
se
&\sphinxstyletheadfamily 
\sphinxAtStartPar
name
&\sphinxstyletheadfamily 
\sphinxAtStartPar
mean
&\sphinxstyletheadfamily 
\sphinxAtStartPar
se
&\sphinxstyletheadfamily 
\sphinxAtStartPar
name
&\sphinxstyletheadfamily 
\sphinxAtStartPar
mean
&\sphinxstyletheadfamily 
\sphinxAtStartPar
se
\\
\hline
\sphinxAtStartPar
\( X_{vr} \)
&
\sphinxAtStartPar
\sphinxhyphen{}11.454
&
\sphinxAtStartPar
0.272
&
\sphinxAtStartPar
\( Y_{T} \)
&
\sphinxAtStartPar
77.34
&
\sphinxAtStartPar
1.23
&
\sphinxAtStartPar
\( N_{\delta} \)
&
\sphinxAtStartPar
\sphinxhyphen{}1.274
&
\sphinxAtStartPar
0.003
\\
\hline
\sphinxAtStartPar
\( X_{rr} \)
&
\sphinxAtStartPar
\sphinxhyphen{}1.406
&
\sphinxAtStartPar
0.068
&
\sphinxAtStartPar
\( Y_{r} \)
&
\sphinxAtStartPar
256.065
&
\sphinxAtStartPar
0.654
&
\sphinxAtStartPar
\( N_{r} \)
&
\sphinxAtStartPar
\sphinxhyphen{}105.618
&
\sphinxAtStartPar
0.179
\\
\hline
\sphinxAtStartPar
\( X_{\delta\delta} \)
&
\sphinxAtStartPar
\sphinxhyphen{}2.719
&
\sphinxAtStartPar
0.013
&
\sphinxAtStartPar
\( Y_{v} \)
&
\sphinxAtStartPar
\sphinxhyphen{}24.467
&
\sphinxAtStartPar
0.02
&
\sphinxAtStartPar
\( N_{T} \)
&
\sphinxAtStartPar
\sphinxhyphen{}32.523
&
\sphinxAtStartPar
0.274
\\
\hline
\sphinxAtStartPar
\( X_{uu} \)
&
\sphinxAtStartPar
80.508
&
\sphinxAtStartPar
0.618
&
\sphinxAtStartPar
\( Y_{ur} \)
&
\sphinxAtStartPar
\sphinxhyphen{}252.991
&
\sphinxAtStartPar
0.658
&
\sphinxAtStartPar
\( N_{u} \)
&
\sphinxAtStartPar
0.063
&
\sphinxAtStartPar
0.001
\\
\hline
\sphinxAtStartPar
\( X_{u} \)
&
\sphinxAtStartPar
\sphinxhyphen{}81.415
&
\sphinxAtStartPar
0.618
&
\sphinxAtStartPar
\( Y_{u} \)
&
\sphinxAtStartPar
\sphinxhyphen{}0.119
&
\sphinxAtStartPar
0.003
&
\sphinxAtStartPar
\( N_{v} \)
&
\sphinxAtStartPar
\sphinxhyphen{}7.156
&
\sphinxAtStartPar
0.016
\\
\hline&&&&&&
\sphinxAtStartPar
\( N_{T\delta} \)
&
\sphinxAtStartPar
\sphinxhyphen{}391.596
&
\sphinxAtStartPar
0.941
\\
\hline&&&&&&
\sphinxAtStartPar
\( N_{vv\delta} \)
&
\sphinxAtStartPar
\sphinxhyphen{}19.257
&
\sphinxAtStartPar
0.089
\\
\hline&&&&&&
\sphinxAtStartPar
\( N_{ur} \)
&
\sphinxAtStartPar
102.252
&
\sphinxAtStartPar
0.183
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
For KVLCC2 comparisons of turning circle advance and tactical diameters compared to the model test result is shown in \hyperref[\detokenize{06.20_results_kvlcc2:tab-kvlcc2-advance}]{Table \ref{\detokenize{06.20_results_kvlcc2:tab-kvlcc2-advance}}}. Predicted advance and tactical diameter differes 2\% and 5\%.


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxthecaptionisattop
\sphinxcaption{KVLCC2 Predicted turning circle advance (A) and tactical diameter (TD) compared to MARIN model tests and IMO limit}\label{\detokenize{06.20_results_kvlcc2:tab-kvlcc2-advance}}
\sphinxaftertopcaption
\begin{tabulary}{\linewidth}[t]{|T|T|T|T|T|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
delta
&\sphinxstyletheadfamily 
\sphinxAtStartPar
A (model test) {[}m{]}
&\sphinxstyletheadfamily 
\sphinxAtStartPar
A (prediction) {[}m{]}
&\sphinxstyletheadfamily 
\sphinxAtStartPar
A (IMO) {[}m{]}
&\sphinxstyletheadfamily 
\sphinxAtStartPar
TD (model test) {[}m{]}
&\sphinxstyletheadfamily 
\sphinxAtStartPar
TD (prediction) {[}m{]}
&\sphinxstyletheadfamily 
\sphinxAtStartPar
TD (IMO) {[}m{]}
\\
\hline
\sphinxAtStartPar
35.0
&
\sphinxAtStartPar
21.59
&
\sphinxAtStartPar
21.21
&
\sphinxAtStartPar
31.5
&
\sphinxAtStartPar
21.72
&
\sphinxAtStartPar
23.07
&
\sphinxAtStartPar
35.0
\\
\hline
\sphinxAtStartPar
\sphinxhyphen{}35.0
&
\sphinxAtStartPar
22.54
&
\sphinxAtStartPar
22.1
&
\sphinxAtStartPar
31.5
&
\sphinxAtStartPar
23.55
&
\sphinxAtStartPar
24.29
&
\sphinxAtStartPar
35.0
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\section{Conclusions}
\label{\detokenize{10.01_conclusions:conclusions}}\label{\detokenize{10.01_conclusions:id1}}\label{\detokenize{10.01_conclusions::doc}}
\sphinxAtStartPar
Using inverse dynamics in the proposed PIT can find the parameters in a VMM exactly if there is no measurement noise and if the selected VMM is a perfect model. This can be seen when identifying parameters in a VMM on data from simulations with the same VMM. In order to succeed in system identification on real model test data, measurement noise needs to be handled and a VMM close as possible to the real ship dynamics needs to be found.

\sphinxAtStartPar
The proposed PIT method requires that the model test data is preprocessed to remove measurement noises. The proposed Iterative EKF and RTS smoother as the preprocessor gives higher accuracy and also avoids the trouble of finding the optimal cut off frequency for using a low\sphinxhyphen{}pass filter.

\sphinxAtStartPar
The proposed PIT applied on the AVMM can reproduce the model test results for the two test cases (wPCC and KVLCC2) with high accuracy. Multicollinearity is however a large problem with AVMM for both the wPCC and KVLCC2 data. As a consequence, some of the regressed hydrodynamic derivatives in the AVMM have unphysically large values and also very large uncertainties. The model is still mathematically correct, where the regressed polynomials fit the training data well.
The regressed polynomial is the sum of very large counteracting coefficients. The model works, as long as the states are similar to the training data. But when extrapolating, it is easy to imagine that the balance between these huge derivatives is disturbed, giving large extrapolation errors very quickly. This behavior was seen when predicting forces and moments with the AVMM on unseen validation data.

\sphinxAtStartPar
The MAVMM has fewer hydrodynamic derivatives with lower multicollinearity and smaller extrapolation errors. Including propeller thrust in the VMM made it possible to obtain high accuracy with fewer hydrodynamic derivatives.

\sphinxAtStartPar
A methodology for cross validation of the PIT was proposed, where available model test data should be split into a training and validation set. The validation set should have larger: drift angles, rudder angles and yaw rates than the training set. Investigating how well a model can make predictions outside its training data was found to be crucial.

\sphinxAtStartPar
The MAVMM was selected for both test vessels based on the cross validation. It was found possible to predict turning circles with less than 5 \% error in advance and tactical diameter, which is well within the margin to the corresponding limits in the IMO standard for both test cases. In the KVLCC2 case the VMM was trained on zigzag model test data from the towing tank at HSVA. This model was able to reproduce turning circle model test data from MARIN with good accuracy. The PIT can thereby be used to develop VMMs from model tests with a free model which has a lot of useful applications. Predicting turning circles from experiments in a narrow towing tank is just one example. A similar PIT could perhaps also be applied on full scale data, which is another interesting application for the future.


\section{Acknowledgements}
\label{\detokenize{acknowledgements:acknowledgements}}\label{\detokenize{acknowledgements::doc}}
\sphinxAtStartPar
The authors would like to acknowledge Energimyndigheten (Swedish Engery Agency) project Data\sphinxhyphen{}driven energy efficiency of ships (project: 49301-1) for providing the resources to prepare this paper, and also tanks all personnel at SSPA that have been involved in the creation of the model test results, building the ship models and conducting the experiments.

\sphinxAtStartPar


\begin{sphinxthebibliography}{HWZL22}
\bibitem[Abk64]{bibligraphy:id25}
\sphinxAtStartPar
M. A. Abkowitz. Ship hydrodynamics \sphinxhyphen{} steering and manoeuvrability. \sphinxstyleemphasis{Hydro\sphinxhyphen{} and Aerodynamics Laboratory, Hydrodynamics Section, Lyngby, Denmark, Report No. Hy\sphinxhyphen{}5, Lectures}, 1964. URL: \sphinxurl{https://repository.tudelft.nl/islandora/object/uuid\%3Ad511bd6b-ca2e-4f10-ad9f-6c881eb1e9f8} (visited on 2020\sphinxhyphen{}08\sphinxhyphen{}24).
\bibitem[Ale22]{bibligraphy:id86}
\sphinxAtStartPar
Martin Alexandersson. wPCC manoeuvring model tests. \sphinxstyleemphasis{Mendeley Data}, 2022. Publisher: Mendeley. URL: \sphinxurl{https://data.mendeley.com/datasets/j5zdrhr9bf} (visited on 2022\sphinxhyphen{}07\sphinxhyphen{}14), \sphinxhref{https://doi.org/10.17632/j5zdrhr9bf.1}{doi:10.17632/j5zdrhr9bf.1}.
\bibitem[Bri93]{bibligraphy:id45}
\sphinxAtStartPar
Jochim E. Brix. \sphinxstyleemphasis{Manoeuvring Technical Manual}. Seehafen\sphinxhyphen{}Verlag, 1993. ISBN 978\sphinxhyphen{}3\sphinxhyphen{}87743\sphinxhyphen{}902\sphinxhyphen{}9. Google\sphinxhyphen{}Books\sphinxhyphen{}ID: CMJ1NAAACAAJ.
\bibitem[Fos21]{bibligraphy:id87}
\sphinxAtStartPar
Thor I. Fossen. \sphinxstyleemphasis{Handbook of Marine Craft Hydrodynamics and Motion Control}. Wiley, Hoboken, NJ, 2nd edition edition, April 2021. ISBN 978\sphinxhyphen{}1\sphinxhyphen{}119\sphinxhyphen{}57505\sphinxhyphen{}4.
\bibitem[HWZL22]{bibligraphy:id82}
\sphinxAtStartPar
Hong\sphinxhyphen{}Wei He, Zi\sphinxhyphen{}Hao Wang, Zao\sphinxhyphen{}Jian Zou, and Yi Liu. Nonparametric modeling of ship maneuvering motion based on self\sphinxhyphen{}designed fully connected neural network. \sphinxstyleemphasis{Ocean Engineering}, 251:111113, May 2022. URL: \sphinxurl{https://linkinghub.elsevier.com/retrieve/pii/S002980182200525X} (visited on 2022\sphinxhyphen{}07\sphinxhyphen{}06), \sphinxhref{https://doi.org/10.1016/j.oceaneng.2022.111113}{doi:10.1016/j.oceaneng.2022.111113}.
\bibitem[Hwa82]{bibligraphy:id80}
\sphinxAtStartPar
Wei Yuan Hwang. CANCELLATION EFFECT AND PARAMETER IDENTIFIABILITY OF SHIP STEERING DYNAMICS. \sphinxstyleemphasis{International Shipbuilding Progress}, 29(332):90–102, 1982. \sphinxhref{https://doi.org/10.3233/isp-1982-2933201}{doi:10.3233/isp\sphinxhyphen{}1982\sphinxhyphen{}2933201}.
\bibitem[IMO02]{bibligraphy:id16}
\sphinxAtStartPar
IMO. Standards for ship manoeuvrability, Resolution MSC 137(76). December 2002.
\bibitem[ITT08]{bibligraphy:id75}
\sphinxAtStartPar
ITTC. The Maneuvering Committee of ITTC, Final report and recommendations to the 25th ITTC, in Proceedings of the 25th International Towing Tank Conference. 2008.
\bibitem[Luo16]{bibligraphy:id56}
\sphinxAtStartPar
Weilin Luo. Parameter Identifiability of Ship Manoeuvring Modeling Using System Identification. \sphinxstyleemphasis{Mathematical Problems in Engineering}, 2016:e8909170, November 2016. Publisher: Hindawi. URL: \sphinxurl{https://www.hindawi.com/journals/mpe/2016/8909170/} (visited on 2021\sphinxhyphen{}10\sphinxhyphen{}04), \sphinxhref{https://doi.org/10.1155/2016/8909170}{doi:10.1155/2016/8909170}.
\bibitem[LGSZ16]{bibligraphy:id36}
\sphinxAtStartPar
Weilin Luo, C. Guedes Soares, and Zaojian Zou. Parameter Identification of Ship Maneuvering Model Based on Support Vector Machines and Particle Swarm Optimization. \sphinxstyleemphasis{Journal of Offshore Mechanics and Arctic Engineering}, 138(3):031101, June 2016. URL: \sphinxurl{https://asmedigitalcollection.asme.org/offshoremechanics/article/doi/10.1115/1.4032892/376874/Parameter-Identification-of-Ship-Maneuvering-Model} (visited on 2020\sphinxhyphen{}08\sphinxhyphen{}24), \sphinxhref{https://doi.org/10.1115/1.4032892}{doi:10.1115/1.4032892}.
\bibitem[Mat17]{bibligraphy:id40}
\sphinxAtStartPar
Jerzy Matusiak. \sphinxstyleemphasis{Dynamics of a Rigid Ship}. Aalto University, 2017. ISBN 978\sphinxhyphen{}952\sphinxhyphen{}60\sphinxhyphen{}7262\sphinxhyphen{}3. Accepted: 2017\sphinxhyphen{}01\sphinxhyphen{}30T10:00:41Z ISSN: 1799\sphinxhyphen{}490X (electronic). URL: \sphinxurl{https://aaltodoc.aalto.fi:443/handle/123456789/24408} (visited on 2021\sphinxhyphen{}06\sphinxhyphen{}17).
\bibitem[POGS15]{bibligraphy:id33}
\sphinxAtStartPar
Lokukaluge P. Perera, P. Oliveira, and C. Guedes Soares. System Identification of Nonlinear Vessel Steering. \sphinxstyleemphasis{Journal of Offshore Mechanics and Arctic Engineering}, 137(3):031302, June 2015. URL: \sphinxurl{https://asmedigitalcollection.asme.org/offshoremechanics/article/doi/10.1115/1.4029826/377000/System-Identification-of-Nonlinear-Vessel-Steering} (visited on 2020\sphinxhyphen{}08\sphinxhyphen{}24), \sphinxhref{https://doi.org/10.1115/1.4029826}{doi:10.1115/1.4029826}.
\bibitem[RST65]{bibligraphy:id67}
\sphinxAtStartPar
H. E. Rauch, C. T. Striebel, and F. Tung. Maximum likelihood estimates of linear dynamic systems. \sphinxstyleemphasis{AIAA Journal}, 3:1445–1450, August 1965. ADS Bibcode: 1965AIAAJ...3.1445R. URL: \sphinxurl{https://ui.adsabs.harvard.edu/abs/1965AIAAJ...3.1445R} (visited on 2022\sphinxhyphen{}03\sphinxhyphen{}04), \sphinxhref{https://doi.org/10.2514/3.3166}{doi:10.2514/3.3166}.
\bibitem[SZPS09]{bibligraphy:id54}
\sphinxAtStartPar
C Shi, D Zhao, J Peng, and C Shen. Identification of Ship Maneuvering Model Using Extended Kalman Filters. \sphinxstyleemphasis{International Journal on Marine Navigation and Safety of Sea Transportation}, 3(1):6, 2009.
\bibitem[SAK+11]{bibligraphy:id79}
\sphinxAtStartPar
F. Stern, K. Agdraup, S. Y. Kim, A. C. Hochbaum, K. P. Rhee, F. Quadvlieg, P. Perdon, T. Hino, R. Broglia, and J. Gorski. Experience from SIMMAN 2008—The First Workshop on Verification and Validation of Ship Maneuvering Simulation Methods. \sphinxstyleemphasis{Journal of Ship Research}, 55(02):135–147, June 2011. URL: \sphinxurl{https://onepetro.org/JSR/article/55/02/135/173675/Experience-from-SIMMAN-2008-The-First-Workshop-on} (visited on 2022\sphinxhyphen{}05\sphinxhyphen{}20), \sphinxhref{https://doi.org/10.5957/jsr.2011.55.2.135}{doi:10.5957/jsr.2011.55.2.135}.
\bibitem[VGO+20]{bibligraphy:id83}
\sphinxAtStartPar
Pauli Virtanen, Ralf Gommers, Travis E. Oliphant, Matt Haberland, Tyler Reddy, David Cournapeau, Evgeni Burovski, Pearu Peterson, Warren Weckesser, Jonathan Bright, Stéfan J. van der Walt, Matthew Brett, Joshua Wilson, K. Jarrod Millman, Nikolay Mayorov, Andrew R. J. Nelson, Eric Jones, Robert Kern, Eric Larson, C. J. Carey, İlhan Polat, Yu Feng, Eric W. Moore, Jake VanderPlas, Denis Laxalde, Josef Perktold, Robert Cimrman, Ian Henriksen, E. A. Quintero, Charles R. Harris, Anne M. Archibald, Antônio H. Ribeiro, Fabian Pedregosa, and Paul van Mulbregt. SciPy 1.0: fundamental algorithms for scientific computing in Python. \sphinxstyleemphasis{Nature Methods}, 17(3):261–272, March 2020. Number: 3 Publisher: Nature Publishing Group. URL: \sphinxurl{https://www.nature.com/articles/s41592-019-0686-2} (visited on 2022\sphinxhyphen{}07\sphinxhyphen{}12), \sphinxhref{https://doi.org/10.1038/s41592-019-0686-2}{doi:10.1038/s41592\sphinxhyphen{}019\sphinxhyphen{}0686\sphinxhyphen{}2}.
\bibitem[WLW+21]{bibligraphy:id47}
\sphinxAtStartPar
Tongtong Wang, Guoyuan Li, Baiheng Wu, Vilmar Æsøy, and Houxiang Zhang. Parameter Identification of Ship Manoeuvring Model Under Disturbance Using Support Vector Machine Method. \sphinxstyleemphasis{Ships and Offshore Structures}, May 2021.
\bibitem[WZ18]{bibligraphy:id58}
\sphinxAtStartPar
Zihao Wang and Zaojian Zou. \sphinxstyleemphasis{Quantifying Multicollinearity in Ship Manoeuvring Modeling by Variance Inflation Factor}. ASME 2018 37th International Conference on Ocean, Offshore and Arctic, Madrid, June 2018. \sphinxhref{https://doi.org/10.1115/OMAE2018-77121}{doi:10.1115/OMAE2018\sphinxhyphen{}77121}.
\bibitem[YY15]{bibligraphy:id22}
\sphinxAtStartPar
H. Yasukawa and Y. Yoshimura. Introduction of MMG standard method for ship maneuvering predictions. \sphinxstyleemphasis{Journal of Marine Science and Technology}, 20(1):37–52, March 2015. URL: \sphinxurl{http://link.springer.com/10.1007/s00773-014-0293-y} (visited on 2020\sphinxhyphen{}08\sphinxhyphen{}25), \sphinxhref{https://doi.org/10.1007/s00773-014-0293-y}{doi:10.1007/s00773\sphinxhyphen{}014\sphinxhyphen{}0293\sphinxhyphen{}y}.
\bibitem[ZHWB17]{bibligraphy:id38}
\sphinxAtStartPar
Man Zhu, Axel Hahn, Yuanqiao Wen, and A. Bolles. Parameter Identification of Ship Maneuvering Models Using Recursive Least Square Method Based on Support Vector Machines. \sphinxstyleemphasis{TransNav, the International Journal on Marine Navigation and Safety of Sea Transportation}, 11(1):23–29, 2017. URL: \sphinxurl{http://www.transnav.eu/Article\_Parameter\_Identification\_of\_Ship\_Zhu,41,694.html} (visited on 2020\sphinxhyphen{}08\sphinxhyphen{}19), \sphinxhref{https://doi.org/10.12716/1001.11.01.01}{doi:10.12716/1001.11.01.01}.
\bibitem[AK76]{bibligraphy:id30}
\sphinxAtStartPar
K. J. Åström and C. G. Källström. Identification of ship steering dynamics. \sphinxstyleemphasis{Automatica}, 12(1):9–22, January 1976. URL: \sphinxurl{http://www.sciencedirect.com/science/article/pii/0005109876900649} (visited on 2020\sphinxhyphen{}11\sphinxhyphen{}11), \sphinxhref{https://doi.org/10.1016/0005-1098(76)90064-9}{doi:10.1016/0005\sphinxhyphen{}1098(76)90064\sphinxhyphen{}9}.
\end{sphinxthebibliography}


\end{document}




\renewcommand{\indexname}{Proof Index}
\begin{sphinxtheindex}
\let\bigletter\sphinxstyleindexlettergroup
\bigletter{ek\sphinxhyphen{}algorithm}
\item\relax\sphinxstyleindexentry{ek\sphinxhyphen{}algorithm}\sphinxstyleindexextra{04.01\_EK}\sphinxstyleindexpageref{04.01_EK:\detokenize{ek-algorithm}}
\end{sphinxtheindex}

\renewcommand{\indexname}{Index}
